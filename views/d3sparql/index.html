<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title></title>
  <meta name="description" />
  <link rel="stylesheet" type="text/css" href="lib/css/style.css" />
<<<<<<< HEAD
  <link rel="stylesheet" type="text/css" href="../semantic/dist/semantic.min.css">
  <link rel="stylesheet" href="lib/css/bootstrap-theme.min.css">
  <script src="../javascripts/bower_components/jquery/dist/jquery.min.js"></script>
  <script src="../javascripts/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
  <script src="../semantic/dist/semantic.min.js"></script>
=======
>>>>>>> 605efe411cacf5f9bb425972e5d2842e34597d46
  <script src="lib/d3/d3.v3.min.js"></script>
  <script src="lib/d3/sankey.js"></script>
  <script src="d3sparql.js"></script>
  <script src="queries.js"></script>
  <script src="lib/js/topojson.min.js"></script>
<<<<<<< HEAD
</head>

<body>
  <div style="margin-top: 3% !important;"></div>
  <h1>Analytical Graphs</h1>
  <div style="margin-top: 30px">

    <div class="ui form">

      <div class="inline fields">
        <div class="seven wide field">

          <div class="ui large dropdown labeled search icon button">
            <i class="bar chart icon"></i>
            <span class="text">Select Graph Type</span>
            <div class="menu">
              <div class="header">Chart</div>
              <div class=" item" data-text="BarChart">BarChart</div>
              <div class=" large item" data-text="PieChart">PieChart</div>
              <div class="header">Graph</div>
              <div class=" item" data-text="ForceGraph">ForceGraph</div>
              <div class=" item" data-text="Sankey">Sankey</div>
              <div class="header">Tree</div>
              <div class=" item" data-text="RoundTree">RoundTree</div>
              <div class=" item" data-text="DendroGram">DendroGram</div>
              <div class=" item" data-text="TreeMap">TreeMap</div>
              <div class=" item" data-text="SunBurst">SunBurst</div>
              <div class=" item" data-text="CirclePack">CirclePack</div>
            </div>
          </div>
        </div>
        <div class="four wide field">

          <div class="ui large button" onclick="toggle()"> Toggle
          </div>
          <div class="ui large right labeled icon button" onclick="exec()">
            <i class="right arrow icon"></i> Show
          </div>
        </div>
      </div>
    </div>

    <input id="endpoint" value="http://dbpedia.org/sparql" type="hidden" class="form-control">
    <textarea id="sparql" class="form-control" rows="15" style="margin:20px 0 30px 0;width:850px;display: inline;"> </textarea>
    <div id="result"></div>
  </div>
  </div>

  <script>
    var selectedgraphtype = "";
    $('.ui.dropdown').dropdown({
      // action: 'combo',
      onChange: function(value, text) {
        selectedgraphtype = text;
        if (selectedgraphtype == 'BarChart') {
          $('#sparql').val(data[0]['query']);
        } else if (selectedgraphtype == 'PieChart') {
          $('#sparql').val(data[0]['query']);
        } else if (selectedgraphtype == 'ForceGraph') {
          $('#sparql').val(data[1]['query']);
        } else if (selectedgraphtype == 'Sankey') {
          $('#sparql').val(data[2]['query']);
        } else if (selectedgraphtype == 'RoundTree') {
          $('#sparql').val(data[3]['query']);
        } else if (selectedgraphtype == 'DendroGram') {
          $('#sparql').val(data[3]['query']);
        } else if (selectedgraphtype == 'TreeMap') {
          $('#sparql').val(data[3]['query']);
        } else if (selectedgraphtype == 'SunBurst') {
          $('#sparql').val(data[3]['query']);
        } else if (selectedgraphtype == 'CirclePack') {
          $('#sparql').val(data[3]['query']);
        }
      }
    });


    $(function() {
      loadQueries();
      d3sparql.toggle();
    });

    function exec() {
      // var selectedgraphtype = d3.select("#graphtype").property("value")
      var endpoint = d3.select("#endpoint").property("value")
      var sparql = d3.select("#sparql").property("value")
      if (selectedgraphtype == 'BarChart') {
        d3sparql.query(endpoint, sparql, barchart)
      } else if (selectedgraphtype == 'PieChart') {
        d3sparql.query(endpoint, sparql, piechart)
      } else if (selectedgraphtype == 'ForceGraph') {
        d3sparql.query(endpoint, sparql, forcegraph)
      } else if (selectedgraphtype == 'Sankey') {
        d3sparql.query(endpoint, sparql, sankey)
      } else if (selectedgraphtype == 'RoundTree') {
        d3sparql.query(endpoint, sparql, roundtree)
      } else if (selectedgraphtype == 'DendroGram') {
        d3sparql.query(endpoint, sparql, dendrogram)
      } else if (selectedgraphtype == 'TreeMap') {
        d3sparql.query(endpoint, sparql, treemap)
      } else if (selectedgraphtype == 'TreeMapZoom') {
        d3sparql.query(endpoint, sparql, treemapzoom)
      } else if (selectedgraphtype == 'SunBurst') {
        d3sparql.query(endpoint, sparql, sunburst)
      } else if (selectedgraphtype == 'CirclePack') {
        d3sparql.query(endpoint, sparql, circlepack)
=======
  <link rel="stylesheet" href="lib/css/bootstrap-theme.min.css">
 <script type='text/javascript' src='lib/js/jquery.min.js'></script>
  <script type='text/javascript' src='lib/js/leaflet.js?2'></script>
  <script src="lib/js/bootstrap.min.js"></script>
  <link rel="stylesheet" type="text/css" href="lib/css/leaflet.css" />

  <script>
    // alert(window.location.hostname);

    $(function() {

      loadQueries();
      d3sparql.toggle();
     // $('#endpoint').val(window.location.origin+'/fuseki/myDataset/query');
    });


    function exec() {

      var selectedgraphtype = d3.select("#graphtype").property("value")
      var endpoint = d3.select("#endpoint").property("value")
      var sparql = d3.select("#sparql").property("value")

      document.getElementById("result").style = "padding-top:50px; text-algin:center; display:table-cell;";

      if (selectedgraphtype == 'BarChart'){
        d3sparql.query(endpoint, sparql, barchart)
        document.getElementById("result").style = "margin-left:0px; padding-top:50px; text-algin:center; display:table-cell;";
      }
      else if (selectedgraphtype == 'PieChart')
        d3sparql.query(endpoint, sparql, piechart)
      else if (selectedgraphtype == 'ScatterPlot')
        d3sparql.query(endpoint, sparql, scatterplot)
      else if (selectedgraphtype == 'ForceGraph')
        d3sparql.query(endpoint, sparql, forcegraph)
      else if (selectedgraphtype == 'Sankey')
        d3sparql.query(endpoint, sparql, sankey)
      else if (selectedgraphtype == 'RoundTree')
        d3sparql.query(endpoint, sparql, roundtree)
      else if (selectedgraphtype == 'DendroGram')
        d3sparql.query(endpoint, sparql, dendrogram)
      else if (selectedgraphtype == 'TreeMap')
        d3sparql.query(endpoint, sparql, treemap)
      else if (selectedgraphtype == 'TreeMapZoom')
        d3sparql.query(endpoint, sparql, treemapzoom)
      else if (selectedgraphtype == 'SunBurst')
        d3sparql.query(endpoint, sparql, sunburst)
      else if (selectedgraphtype == 'CirclePack')
        d3sparql.query(endpoint, sparql, circlepack)
      else if (selectedgraphtype == 'OpenStreetMap'){
        markerDelAgain();
        document.getElementById("map").style = 'padding-top:20px;width: 850px; height: 480px; border: 1px solid #AAA;  position:relative; left:0px';
        document.getElementById("result").style.display = 'none';
        sparqlQueryJson(sparql, endpoint, myCallback, true);
      }

      if (selectedgraphtype != 'OpenStreetMap'){
        document.getElementById("map").style = 'position:absolute; left:-100000px';
        document.getElementById("result").style.display = 'block';

        if(map !== "null" && map!== "undefined"){
	   map.setView(new L.LatLng(20.0, 5.0), 2);
	}
>>>>>>> 605efe411cacf5f9bb425972e5d2842e34597d46
      }
    }

    function barchart(json) {
      var config = {
        "label_x": "Type",
        "label_y": "Number",
        "var_x": "conceptType",
        "var_y": "value",
<<<<<<< HEAD
        "width": 800, // canvas width
=======
        "width": 850, // canvas width
>>>>>>> 605efe411cacf5f9bb425972e5d2842e34597d46
        "height": 450, // canvas height
        "margin": 140, // canvas margin
        "selector": "#result"
      }
      d3sparql.barchart(json, config)
    }

    function piechart(json) {
      var config = {
        "label": "conceptType",
        "size": "value",
<<<<<<< HEAD
        "width": 800, // canvas width
=======
        "width": 1000, // canvas width
>>>>>>> 605efe411cacf5f9bb425972e5d2842e34597d46
        "height": 600, // canvas height
        "margin": 10, // canvas margin
        "hole": 200, // doughnut hole: 0 for pie, r > 0 for doughnut
        "selector": "#result"
      }
      d3sparql.piechart(json, config)
    }

<<<<<<< HEAD
    function forcegraph(json) {
      var config = {
        "charge": -400,
        "distance": 50,
        "width": 800,
        "height": 700,
=======
    function scatterplot(json) {
      var config = {
        "label_x": "genome size (bp) -- circle size corresponds to # of histidine kinase domains",
        "label_y": "# of genes",
        "var_x": "length",
        "var_y": "genes",
        "var_r": "hks",
        "min_r": 1,
        "max_r": 20,
        "width": 850,
        "height": 300,
        "margin_x": 80,
        "margin_y": 40,
        "selector": "#result"
      }
      d3sparql.scatterplot(json, config)
      //d3sparql.htmltable(json)
    }

    function forcegraph(json) {
      var config = {
        "charge": -500,
        "distance": 50,
        "width": 850,
        "height": 550,
>>>>>>> 605efe411cacf5f9bb425972e5d2842e34597d46
        "selector": "#result"
      }
      d3sparql.forcegraph(json, config)
    }

    function sankey(json) {
      var config = {
<<<<<<< HEAD
=======
        // for d3sparql.graph()
>>>>>>> 605efe411cacf5f9bb425972e5d2842e34597d46
        "key1": "parent",
        "key2": "child",
        "label1": "parent_name",
        "label2": "child_name",
<<<<<<< HEAD
        "width": 800,
        "height": 750,
=======
        // for d3sparql.sankey()
        "width": 750,
        "height": 1200,
>>>>>>> 605efe411cacf5f9bb425972e5d2842e34597d46
        "margin": 10,
        "selector": "#result"
      }
      d3sparql.sankey(json, config)
    }

    function roundtree(json) {
      var config = {
<<<<<<< HEAD
        "root": "root_name",
        "parent": "parent_name",
        "child": "child_name",
=======
        // for d3sparql.tree()
        "root": "root_name",
        "parent": "parent_name",
        "child": "child_name",
        // for d3sparql.roundtree()
>>>>>>> 605efe411cacf5f9bb425972e5d2842e34597d46
        "diameter": 800,
        "angle": 360,
        "depth": 200,
        "radius": 20,
        "selector": "#result"
      }
      d3sparql.roundtree(json, config)
    }

    function dendrogram(json) {
      var config = {
<<<<<<< HEAD
        "root": "root_name",
        "parent": "parent_name",
        "child": "child_name",
        "width": 800,
        "height": 750,
        "margin": 300,
        "radius": 10,
=======
        // for d3sparql.tree()
        "root": "root_name",
        "parent": "parent_name",
        "child": "child_name",
        // for d3sparql.dendrogram()
        "width": 850,
        "height": 1000,
        "margin": 300,
        "radius": 25,
>>>>>>> 605efe411cacf5f9bb425972e5d2842e34597d46
        "selector": "#result"
      }
      d3sparql.dendrogram(json, config)
    }

    function treemap(json) {
      var config = {
<<<<<<< HEAD
        "root": "root_name",
        "parent": "parent_name",
        "child": "child_name",
        "width": 800,
=======
        // for d3sparql.tree()
        "root": "root_name",
        "parent": "parent_name",
        "child": "child_name",
        // for d3sparql.treemap()
        "width": 850,
>>>>>>> 605efe411cacf5f9bb425972e5d2842e34597d46
        "height": 520,
        "selector": "#result"
      }
      d3sparql.treemap(json, config)
    }

    function treemapzoom(json) {
      var config = {
<<<<<<< HEAD
        "width": 800,
=======
        "width": 850,
>>>>>>> 605efe411cacf5f9bb425972e5d2842e34597d46
        "height": 500,
        "selector": "#result"
      }
      d3sparql.treemapzoom(json, config)
    }

    function sunburst(json) {
      var config = {
<<<<<<< HEAD
        "root": "root_name",
        "parent": "parent_name",
        "child": "child_name",
        "width": 800,
=======
        // for d3spraql.tree()
        "root": "root_name",
        "parent": "parent_name",
        "child": "child_name",
        // for d3sparql.sunburst()
        "width": 850,
>>>>>>> 605efe411cacf5f9bb425972e5d2842e34597d46
        "height": 720,
        "margin": 50,
        "selector": "#result"
      }
      d3sparql.sunburst(json, config)
    }

    function circlepack(json) {
      var config = {
<<<<<<< HEAD
        "root": "root_name",
        "parent": "parent_name",
        "child": "child_name",
        "width": 800,
=======
        // for d3sparql.tree()
        "root": "root_name",
        "parent": "parent_name",
        "child": "child_name",
        // for d3sparql.circlepack()
        "width": 850,
>>>>>>> 605efe411cacf5f9bb425972e5d2842e34597d46
        "height": 850,
        "diameter": 700,
        "selector": "#result"
      }
      d3sparql.circlepack(json, config)
    }

    function coordmap(json) {
      var config = {
        "var_lat": "lat",
        "var_lng": "lng",
<<<<<<< HEAD
        "width": 800,
=======
        "width": 850,
>>>>>>> 605efe411cacf5f9bb425972e5d2842e34597d46
        "height": 400,
        "radius": 5,
        "color": "#55C25E",
        "topojson": "lib/d3/map/world-50m.json",
        "selector": "#result"
      }
      d3sparql.coordmap(json, config)
    }

    function namedmap(json) {
      var config = {
        "label": "label",
        "value": "size",
        "color_max": "red",
        "topojson": "lib/d3/map/japan.topojson",
        "mapname": "japan",
        "keyname": "name_local",
        "center_lat": 34,
        "center_lng": 137,
        "scale": 10000,
        "selector": "#result"
      }
      d3sparql.namedmap(json, config)
    }

<<<<<<< HEAD
=======
    function exec_offline() {
      d3.json("cache/dbpedia/area-ja.json", render)
    }

>>>>>>> 605efe411cacf5f9bb425972e5d2842e34597d46
    function toggle() {
      d3sparql.toggle()
    }

<<<<<<< HEAD
    function exec_offline() {
      d3.json("cache/dbpedia/area-ja.json", render)
    }

    function loadQueries() {
      var pathName = window.location.pathname;
      var dynamicPath = "";
      if (pathName.split('/').length === 4)
        dynamicPath = '/' + pathName.split('/')[1];
=======

    function loadQueries() {

    var pathName = window.location.pathname;
    var dynamicPath = "";


      if(pathName.split('/').length === 4)
         dynamicPath = '/'+pathName.split('/')[1];

>>>>>>> 605efe411cacf5f9bb425972e5d2842e34597d46
      for (var i = 0; i < data.length; i++) {
        $('#queries').append($("<option/>", {
          value: i,
          text: data[i]['name']
        }));
<<<<<<< HEAD
        if (i == 0) {
          $('#sparql').val(data[i]['query']);
          $('#endpoint').val(data[i]['endpoint'].replace('domain', window.location.origin + dynamicPath));
        }
      }
    }
  </script>
  <style>
    .ui.dropdown .menu>.item {
      font-size: 1.2rem;
=======

        if (i == 0){
          $('#sparql').val(data[i]['query']);
         $('#endpoint').val(data[i]['endpoint'].replace('domain', window.location.origin+dynamicPath));
	}
      }
    }

    function getval(sel) {
      $('#sparql').val(data[sel.value]['query']);
      $('#endpoint').val(data[sel.value]['endpoint'].replace('domain', window.location.origin+dynamicPath));
    }
  </script>
  <style>
    .navbar-brand {
      float: left;
      height: 50px;
      font-size: 18px;
      line-height: 20px;
      padding: 15px;
    }

    .navbar-brand:hover,
    .navbar-brand:focus {
      text-decoration: none;
    }

    .navbar-brand > img {
      display: block;
>>>>>>> 605efe411cacf5f9bb425972e5d2842e34597d46
    }

    .bar:hover {
      fill: brown;
    }

    text {
      font-size: 11px;
      pointer-events: none;
    }

    text.parent {
      fill: #1f77b4;
    }

    circle {
      fill: #ccc;
      stroke: #999;
      pointer-events: all;
    }

    circle.parent {
      fill: #1f77b4;
      fill-opacity: .1;
      stroke: steelblue;
    }

    circle.parent:hover {
      stroke: #ff7f0e;
      stroke-width: .5px;
    }

    circle.child {
      pointer-events: none;
    }
  </style>
<<<<<<< HEAD
=======
</head>

<body>

  <nav class="navbar navbar-inverse navbar-fixed-top">

    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" ar$ <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>

        <a class="navbar-brand" href="/"><div id="projectTitle"></div></a>
      </div>
      <div id="navbar" class="collapse navbar-collapse">

        <div id="menuHeader"></div>

      </div>
    </div>


  </nav>
  <div class="container">
    <h3>Analytics</h3>

    <div style="margin-top: 30px">
      <table style="border-spacing:5em;">
        <tbody>
          <tr>
            <td width="150px">
              <label for="graphtype">Graph Type:</label>
            </td>
            <td width="300px">
              <select class="form-control" id="graphtype">
                <optgroup label="Chart">
                  <option val="barchart">BarChart</option>
                  <option val="piechart">PieChart</option>
                </optgroup>
                <optgroup label="Graph">
                  <option val="forcegraph">ForceGraph</option>
                  <option val="sankey">Sankey</option>
                </optgroup>
                <optgroup label="Tree">
                  <option val="roundtree">RoundTree</option>
                  <option val="dendrogram">DendroGram</option>
                  <option val="treemap">TreeMap</option>
                  <option val="sunburst">SunBurst</option>
                  <option val="circlepack">CirclePack</option>
                </optgroup>
                <optgroup label="Map">
                  <option val="openstreetmap">OpenStreetMap</option>
                </optgroup>
              </select>
            </td>
            <td width="20px"></td>
            <td width="80px">
              <label for="queries">Query:</label>
            </td>
            <td width="300px">
              <select class="form-control" id="queries" onchange="getval(this);">
              </select>
            </td>
          </tr>

          <tr>
            <td style="padding-top:10px">
              <label>SPARQL endpoint:</label>
            </td>
            <td colspan="3" style="padding-top:10px">
              <input id="endpoint" value="http://dbpedia.org/sparql" type="text" class="form-control">
            </td>
	    <td align="right" style="padding-top:10px">
              <button class="btn btn-primary" onclick="exec()" style="width:130px; float:right">Execute</button>
              <button class="btn btn-primary" onclick="toggle()" style="width:130px; height:34px; float:right; margin-right:10px" type="button" data-toggle="button" aria-pressed="false" autocomplete="off"><i id="button" class="icon-chevron-up"></i>Toggle</button>
            </td>

          </tr>
        </tbody>
      </table>
      <textarea id="sparql" class="form-control" rows="15" style="margin:20px 0 30px 0;width:850px;display: inline;"> </textarea>
    </div>
    <div style="padding-top:50px; text-algin:center; display:table-cell;" id="result"></div>
    <div id="map" style="padding-top:20px; width: 850px; height: 480px; border: 1px solid #AAA; position:absolute; left:-100000px"></div>
    <script type='text/javascript' src='maps/leaf-demo.js'></script>
  </div>


>>>>>>> 605efe411cacf5f9bb425972e5d2842e34597d46

</body>

</html>
